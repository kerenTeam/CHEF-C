<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <title>浏览器定位</title>
    <link rel="stylesheet" href="http://cache.amap.com/lbs/static/main1119.css" />
    <link href="/Content/css/amazeui.min.css" rel="stylesheet">
    @*<link href="/Content/css/app.css" rel="stylesheet">
    <link href="/Content/css/public.css" rel="stylesheet">
    <link href="/Content/css/personal.css" rel="stylesheet">*@
    <!-- <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=61eb3dd738aebf40b63eacbf3c447bdf"></script> -->
    <!-- <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=61eb3dd738aebf40b63eacbf3c447bdf&plugin=AMap.Geocoder"></script> -->
    <!-- <script type="text/javascript" src="http://cache.amap.com/lbs/static/addToolbar.js"></script> -->
    @*<script src="/Content/js/jquery.min.js"></script>*@
    <style type="text/css">
    #test {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    
    .backA {
        display: inline-block;
        font-size: 20px;
        z-index: 999999;
        position: fixed;
        width: 3rem;
        height: 47px;
        line-height: 47px;
        text-align: center;
        background: rgb(248, 248, 248);
    }
    </style>
</head>
    <body>
        <a href="javascript:history.go(-1)" class="backA">
            <i class="am-header-icon am-icon-chevron-left"></i>
        </a>
        <iframe src="http://m.amap.com/picker/?keywords=写字楼,小区,学校&zoom=17&key=8f29aefac8547821425571df8852f64b" id="test" name="map"></iframe>
        <!-- <script type="text/javascript" src="http://m.amap.com/picker/?key=8f29aefac8547821425571df8852f64b"></script> -->
        <script type="text/javascript">
        (function() {
            $('.picker-index').delegate('click', $('.back'), function() {
                alert(123)
                window.location.href = 'addAddress';
            })


            var iframe = document.getElementById('test').contentWindow;
            setTimeout(function() {
                iframe.postMessage('hello', 'http://m.amap.com/picker/');
            }, 500)
            window.addEventListener("message", function (e) {
                alert(123);
                console.log(e.data);
                alert(e.data);
                //window.location.href = 'addAddress?name=' + encodeURI(e.data.name) + '&address=' + encodeURI(e.data.address)
                top.location.href = 'addAddress?name=' + encodeURI(e.data.name) + '&address=' + encodeURI(e.data.address)
            }, false);
        }())
        </script>
    </body>

</html>
